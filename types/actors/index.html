<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Actors - Pony Tutorial</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/highlight.css" rel="stylesheet">
  <link href="../../css/theme_extra.css" rel="stylesheet">

  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script>
  <script src="../../js/highlight.pack.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Pony Tutorial</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
      <ul class="current">
    
        
            <li class="toctree-l1 ">
                <a class="" href="../..">Home</a>
                
            </li>
        

    
        
            <span>Getting started</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../..">Welcome!</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../getting-started/what-you-need-to-start/">What you need to start</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../getting-started/installation/">Installation</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../getting-started/helloworld/">Helloworld</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../getting-started/how-it-works/">How it works</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../getting-started/whitespace/">Whitespace</a>
                    
                </li>
            
        

    
        
            <span>Types</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../static-vs-dynamic/">Static vs dynamic</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../classes/">Classes</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../primitives/">Primitives</a>
                    
                </li>
            
                <li class="toctree-l2 current">
                    <a class="current" href="./">Actors</a>
                    
                        <ul>
                        
                            <li class="toctree-l3"><a href="#behaviours">Behaviours</a></li>
                            
                        
                            <li class="toctree-l3"><a href="#concurrent">Concurrent</a></li>
                            
                        
                            <li class="toctree-l3"><a href="#sequential">Sequential</a></li>
                            
                        
                            <li class="toctree-l3"><a href="#why-is-this-safe">Why is this safe?</a></li>
                            
                        
                            <li class="toctree-l3"><a href="#actors-are-cheap">Actors are cheap</a></li>
                            
                        
                        </ul>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../traits-and-interfaces/">Traits and interfaces</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../type-aliases/">Type aliases</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../type-expressions/">Type expressions</a>
                    
                </li>
            
        

    
        
            <span>Capabilities</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../capabilities/introduction/">Introduction</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../capabilities/guarantees/">Guarantees</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../capabilities/aliasing/">Aliasing</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../capabilities/combining-capabilities/">Combining capabilities</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../capabilities/passing-and-sharing/">Passing and sharing</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../capabilities/capability-subtyping/">Capability subtyping</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../capabilities/arrow-types/">Arrow types</a>
                    
                </li>
            
        

    
        
            <span>Expressions</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../expressions/variables/">Variables</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../expressions/infix-ops/">Infix ops</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../expressions/control-structures/">Control structures</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../expressions/methods/">Methods</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../expressions/exceptions/">Exceptions</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../expressions/sugar/">Sugar</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../expressions/object-literals/">Object literals</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../expressions/partial-application/">Partial application</a>
                    
                </li>
            
        

    
        
            <span>Actors</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../actors/behaviours/">Behaviours</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../actors/capabilities/">Capabilities</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../actors/recover-and-consume/">recover and consume</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../actors/arrow-types/">Arrow types</a>
                    
                </li>
            
        

    
        
            <span>Packages</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../packages/package-system/">Package system</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../packages/builtin/">Builtin</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../packages/use-statement/">Using a package</a>
                    
                </li>
            
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../../composition-inheritance/code-sharing/">Composition vs. inheritance</a>
                
            </li>
        

    
        
            <span>Generics</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../generics/polymorphic-types/">Polymorphic types</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../generics/polymorphic-methods/">Polymorphic methods</a>
                    
                </li>
            
        

    
        
            <span>Pattern matching</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../pattern-matching/match/">match-expression</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../pattern-matching/as/">as-expression</a>
                    
                </li>
            
        

    
        
            <span>Platform</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../platform/platform/">Platform</a>
                    
                </li>
            
        

    
        
            <span>Editor support</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../editor-plugins/plugins/">Plugins</a>
                    
                </li>
            
        

    
        
            <span>Compiler options</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../compiler-clargs/clargs/">Overview</a>
                    
                </li>
            
        

    
        
            <span>Patterns</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../patterns/patterns/">Patterns</a>
                    
                </li>
            
        

    
        
            <span>Garbage collection</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../garbage-collection/garbage-collection/">Garbage collection</a>
                    
                </li>
            
        

    
        
            <span>C-FFI</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../c-ffi/calling-c/">Calling C programs</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../c-ffi/linking-c/">Linking to C libraries</a>
                    
                </li>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../c-ffi/c-abi/">Exposing a C-ABI</a>
                    
                </li>
            
        

    
        
            <span>Examples</span>
            
                <li class="toctree-l2 ">
                    <a class="" href="../../examples/examples/">Examples</a>
                    
                </li>
            
        

    
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Pony Tutorial</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        <li>Types &raquo;</li>
      
    
    <li>Actors</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              <p>An <strong>actor</strong> is similar to a <strong>class</strong>, but with one critical difference: an actor can have <strong>behaviours</strong>.</p>
<h1 id="behaviours">Behaviours</h1>
<p>A <strong>behaviour</strong> is like a <strong>function</strong>, except that functions are <em>synchronous</em> and behaviours are <em>asynchronous</em>. In other words, when you call a function, the body of the function is executed immediately, and the result of the call is the result of the body of the function. This is just like method invocation in any other object-oriented language.</p>
<p>But when you call a behaviour, the body is <strong>not</strong> executed immediately. Instead, the body of the behaviour will execute at some indeterminate time in the future.</p>
<p>A behaviour looks like a function, but instead of being introduced with the keyword <code>fun</code>, it is introduced with the keyword <code>be</code>.</p>
<p>Like a function, a behaviour can have parameters. Unlike a function, it doesn't have a receiver capability (a behaviour can be called on a receiver of any capability) and you can't specify a return type.</p>
<p><strong>So what does a behaviour return?</strong> All behaviours always return the receiver. They can't return something they calculate (since they haven't run yet), so returning the receiver is a convenience to allow chaining calls on the receiver.</p>
<pre><code class="pony">actor Aardvark
  let name: String
  var _hunger_level: U64 = 0

  new create(name': String) =&gt;
    name = name'

  be eat(amount: U64) =&gt;
    _hunger_level = _hunger_level - amount.min(_hunger_level)
</code></pre>

<p>Here we have an <code>Aardvark</code> that can eat asynchronously. Clever Aardvark.</p>
<h1 id="concurrent">Concurrent</h1>
<p>Since behaviours are asynchronous, it's ok to run the body of a bunch of behaviours at the same time. This is exactly what Pony does. The Pony runtime has its own scheduler, which by default has a number of threads equal to the number of CPU cores on your machine. Each scheduler thread can be executing an actor behaviour at any given time, so Pony programs are naturally concurrent.</p>
<h1 id="sequential">Sequential</h1>
<p>Actors themselves, however, are sequential. That is, each actor will only execute one behaviour at a time. This means all the code in an actor can be written without caring about concurrency: no need for locks or semaphores or anything like that.</p>
<p>When you're writing Pony code, it's nice to think of actors not as a unit of parallelism, but as a unit of sequentiality. That is, an actor should do only what <em>has</em> to be done sequentially. Anything else can be broken out into another actor, making it automatically parallel.</p>
<h1 id="why-is-this-safe">Why is this safe?</h1>
<p>Because of Pony's <strong>capabilities secure type system</strong>. We've mentioned capabilities briefly before, when talking about function receiver capabilities. The short version is that they are annotations on a type that make all this parallelism safe without any runtime overhead.</p>
<p>We will cover capabilities in depth later.</p>
<h1 id="actors-are-cheap">Actors are cheap</h1>
<p>If you've done concurrent programming before, you'll know that threads can be expensive. Context switches can cause problems, each thread needs a stack (which can be a lot of memory), and you need lots of locks and other mechanisms to write thread-safe code.</p>
<p>But actors are cheap. Really cheap. The extra cost of an actor as opposed to an object is about 256 bytes of memory. Bytes, not kilobytes! And there are no locks and no context switches. An actor that isn't executing consumes no resources other than the few extra bytes of memory.</p>
<p>It's pretty normal to write a Pony program that uses hundreds of thousands of actors.</p>
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../traits-and-interfaces/" class="btn btn-neutral float-right" title="Traits and interfaces"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../primitives/" class="btn btn-neutral" title="Primitives"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
      <span><a href="../primitives/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      <span style="margin-left: 15px"><a href="../traits-and-interfaces/" style="color: #fcfcfc">Next &raquo;</a></span>
    </span>
</div>

<!--
MkDocs version  : 0.12.2
Docs Build Date : 2015-05-25 11:10:06.057895
-->
</body>
</html>