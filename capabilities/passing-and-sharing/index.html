<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Passing and sharing - Pony Tutorial</title>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/theme_extra.css" rel="stylesheet">

  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script>

  <style>
    body {font-size: 90%;}
    pre, code {font-size: 100%;}
    h3, h4, h5, h6 {color: #2980b9; font-weight: 300}
  </style> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Pony Tutorial</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
      <ul class="current">
    
        
        <span>Installation</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../installation/mac-osx">Mac OSX</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../installation/linux">Linux</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../installation/windows">Windows</a>
                    
                </li>
            
        

    
        
        <span>Getting started</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../getting-started/what-you-need-to-start">What you need to start</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../getting-started/helloworld">Helloworld</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../getting-started/how-it-works">How it works</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../getting-started/whitespace">Whitespace</a>
                    
                </li>
            
        

    
        
        <span>Types</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../types/static-vs-dynamic">Static vs dynamic</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../types/classes">Classes</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../types/primitives">Primitives</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../types/actors">Actors</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../types/traits-and-interfaces">Traits and interfaces</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../types/type-aliases">Type aliases</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../types/type-expressions">Type expressions</a>
                    
                </li>
            
        

    
        
        <span>Capabilities</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../type-qualifiers">Type qualifiers</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../guarantees">Guarantees</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../aliasing">Aliasing</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../combining-capabilities">Combining capabilities</a>
                    
                </li>
            
                <li class="toctree-l1 current">
                    <a class="current" href=".">Passing and sharing</a>
                    
                        <ul>
                        
                            <li class="toctree-l2"><a href="#passing">Passing</a></li>
                            
                        
                            <li class="toctree-l2"><a href="#sharing">Sharing</a></li>
                            
                        
                            <li class="toctree-l2"><a href="#capabilities-that-cant-be-sent">Capabilities that can't be sent</a></li>
                            
                        
                        </ul>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../capability-subtyping">Capability subtyping</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../arrow-types">Arrow types</a>
                    
                </li>
            
        

    
        
        <span>Expressions</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../expressions/variables">Variables</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../expressions/infix-ops">Infix ops</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../expressions/control-structures">Control structures</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../expressions/methods">Methods</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../expressions/exceptions">Exceptions</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../expressions/sugar">Sugar</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../expressions/object-literals">Object literals</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../expressions/partial-application">Partial application</a>
                    
                </li>
            
        

    
        
        <span>Actors</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../actors/behaviours">Behaviours</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../actors/capabilities">Capabilities</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../actors/recover-and-consume">recover and consume</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../actors/arrow-types">Arrow types</a>
                    
                </li>
            
        

    
        
        <span>Packages</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../packages/package-system">Package system</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../packages/builtin">Builtin</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../packages/use-statement">Using a package</a>
                    
                </li>
            
        

    
        
        <span>Composition vs. inheritance</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../composition-inheritance/code-sharing">Code sharing</a>
                    
                </li>
            
        

    
        
        <span>Generics</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../generics/polymorphic-types">Polymorphic types</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../generics/polymorphic-methods">Polymorphic methods</a>
                    
                </li>
            
        

    
        
        <span>Pattern matching</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../pattern-matching/match">match-expression</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../pattern-matching/as">as-expression</a>
                    
                </li>
            
        

    
        
        <span>Platform</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../platform/platform">Platform</a>
                    
                </li>
            
        

    
        
        <span>Editor support</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../editor-plugins/plugins">Plugins</a>
                    
                </li>
            
        

    
        
        <span>Compiler options</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../compiler-clargs/clargs">Overview</a>
                    
                </li>
            
        

    
        
        <span>Patterns</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../patterns/patterns">Patterns</a>
                    
                </li>
            
        

    
        
        <span>Garbage collection</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../garbage-collection/garbage-collection">Garbage collection</a>
                    
                </li>
            
        

    
        
        <span>C-FFI</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../c-ffi/calling-c">Calling C programs</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../c-ffi/linking-c">Linking to C libraries</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../c-ffi/c-abi">Exposing a C-ABI</a>
                    
                </li>
            
        

    
        
        <span>Examples</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../examples/examples">Examples</a>
                    
                </li>
            
        

    
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="../.."></a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    <li>Passing and sharing</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              <p>Capabilities make it safe to both <strong>pass</strong> mutable data between actors and to <strong>share</strong> immutable data amongst actors. Not only that, they make it safe to do it with no copying, no locks, in fact no runtime overhead at all.</p>
<h1 id="passing">Passing</h1>
<p>For an object to be mutable, we need to be sure that no <em>other</em> actor can read from or write to that object. The three mutable capabilities (<code>iso</code>, <code>trn</code>, and <code>ref</code>) all make that guarantee.</p>
<p>But what if we want to pass a mutable object from one actor to another? To do that, we need to be sure that the actor that is <em>sending</em> the mutable object also <em>gives up</em> the ability to both read from and write to that object.</p>
<p>This is exactly what <code>iso</code> does. It is <em>read and write unique</em>, there can only be one reference at a time that can be used for reading or writing. If you send an <code>iso</code> object to another actor, you will be giving up the ability to read from or write to that object.</p>
<p><strong>So I should use <code>iso</code> when I want to pass a mutable object between actors?</strong> Yes! If you don't need to pass it, you can just use <code>ref</code> instead.</p>
<h1 id="sharing">Sharing</h1>
<p>If you want to <strong>share</strong> an object amongst actors, then we have to make one of the following guarantees:</p>
<ol>
<li>Either <em>no</em> actor can write to the object, in which case <em>any</em> actor can read from it, or</li>
<li>Only <em>one</em> actor can write to the object, in which case <em>other</em> actors can neither read from or write to the object.</li>
</ol>
<p>The first guarantee is exactly what <code>val</code> does. It is <em>globally immutable</em>, so we know that <em>no</em> actor can ever write to that object. As a result, you can freely send <code>val</code> objects to other actors, without needing to give up the ability to read from that object.</p>
<p><strong>So I should use <code>val</code> when I want to share an immutable object amongst actors?</strong> Yes! If you don't need to share it, you can just use <code>ref</code> instead, or <code>box</code> if you want it to be immutable.</p>
<p>The second guarantee is what <code>tag</code> does. Not the part about only one actor writing (that's guaranteed by any mutable capability), but the part about not being able to read from or write to an object. That means you can freely pass <code>tag</code> objects to other actors, without needing to give up the ability to read from or write to that object.</p>
<p><strong>What's the point in sending a tag reference to another actor if it can't then read of write the fields?</strong> Because <code>tag</code> <strong>can</strong> be used to <strong>identify</strong> objects and sometimes that's all you need. Also, if the object is an actor you can call behaviours on it even though you only have a <code>tag</code>.</p>
<p><strong>So I should use <code>tag</code> when I want to share the identity of a mutable object amongst actors?</strong> Yes! Or, really, the identity of anything, whether it's mutable, immutable, or even an actor.</p>
<h1 id="capabilities-that-cant-be-sent">Capabilities that can't be sent</h1>
<p>You may have noticed we didn't mention <code>trn</code>, <code>ref</code>, or <code>box</code> as things you can send to other actors. That's because you can't do it. They don't make the guarantees we need in order to be safe.</p>
<p>So when should you use those capabilities?</p>
<ul>
<li>Use <code>ref</code> when you need to be able to change an object over time. On the other hand, if your program wouldn't be any slower if you used an immutable type instead, you may want to use a <code>val</code> anyway.</li>
<li>Use <code>box</code> when you don't care whether the object is mutable or immutable. In other words, you want to be able to read from it, but you don't need to write to it or share it with other actors.</li>
<li>Use <code>trn</code> when you want to be able to change an object for a while, but you also want to be able to make it <em>globally immutable</em> later.</li>
</ul>

            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../capability-subtyping" class="btn btn-neutral float-right" title="Capability subtyping"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../combining-capabilities" class="btn btn-neutral" title="Combining capabilities"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
      <span><a href="../combining-capabilities" style="color: #fcfcfc;">&laquo; Previous</a></span>
      <span style="margin-left: 15px"><a href="../capability-subtyping" style="color: #fcfcfc">Next &raquo;</a></span>
    </span>
</div>
</body>
</html>